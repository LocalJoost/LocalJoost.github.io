---
layout: post
title: Using a HoloLens scanned room inside your HoloLens app
date: '2017-02-03T22:04:00.000+01:00'
author: Joost van Schaik
tags:
- HoloLens
- Unity3D
modified_time: '2017-02-05T16:30:15.251+01:00'
thumbnail: https://lh3.googleusercontent.com/-HguwOE42N40/WJTwLkh0h9I/AAAAAAAAOpI/SbpNK-8exZ4/s72-c/image_thumb%25255B2%25255D.png?imgmax=800
blogger_id: tag:blogger.com,1999:blog-5295746446529817470.post-2446186333508681868
blogger_orig_url: https://dotnetbyexample.blogspot.com/2017/02/using-hololens-scanned-room-inside-your.html
---

<p>HoloLens can interact with reality – that’s why it’s a mixed reality device, after all. The problem is, sometimes, the reality you need is not always available. For example, if the app needs to run in a room or facility at a (client) location you only have limited access to. And you have to locate stuff on places relative to places in the room. Now you can of course use the simulation in the device portal and capture the room. </p> <p><a href="https://lh3.googleusercontent.com/-iqmfhq4u_-g/WJTwK9JieFI/AAAAAAAAOpE/w5NHi9HfO9M/s1600-h/image%25255B4%25255D.png"><img title="image" style="border-left-width: 0px; border-right-width: 0px; background-image: none; border-bottom-width: 0px; padding-top: 0px; padding-left: 0px; display: inline; padding-right: 0px; border-top-width: 0px" border="0" alt="image" src="https://lh3.googleusercontent.com/-HguwOE42N40/WJTwLkh0h9I/AAAAAAAAOpI/SbpNK-8exZ4/image_thumb%25255B2%25255D.png?imgmax=800" width="654" height="421"></a></p> <p>You can save the room into an XEF file and upload that to (another) HoloLens. That works fine runtime, but in Unity that doesn’t help you much with getting a feeling of the space, and moreover, it messes with your HoloLens’ spatial mapping. I don’t like to use it on a real live HoloLens.</p> <p>There is another option though, in the 3D view tab</p> <p><a href="https://lh3.googleusercontent.com/-lyPD6orWqRQ/WJTwMdAOs2I/AAAAAAAAOpM/_7iGAV0-Q24/s1600-h/image%25255B8%25255D.png"><img title="image" style="border-left-width: 0px; border-right-width: 0px; background-image: none; border-bottom-width: 0px; padding-top: 0px; padding-left: 0px; display: inline; padding-right: 0px; border-top-width: 0px" border="0" alt="image" src="https://lh3.googleusercontent.com/-_ZeXY9N1Ch0/WJTwM4niPhI/AAAAAAAAOpQ/8Lvp08eLz8s/image_thumb%25255B4%25255D.png?imgmax=800" width="654" height="524"></a></p> <p>If you click “update”, you will see a rendering of the space the HoloLens has recognized, belonging to the ‘space’ it finds itself in. Basically, the whole mesh. In this case, my ground and first floor of my house (I never felt like taking the HoloLens to 2nd floor). If you click “Save” it will offer to save a SpatialMapping.obj. That simple WaveFront Object format. And this is something you actually <em>can use in Unity</em>.</p> <p>Only it looks rather crappy. Even if you know what you are looking at. This is the side of my house, with left bottom the living (the rectangular thing is the large cupboard), on top of that the master bedroom* with the slanted roof, and if you look carefully, you can see the stairs coming up from the hallway a little right of center, at the bottom of the house. </p> <p><a href="https://lh3.googleusercontent.com/-RMLkvb5RuY0/WJTwN_HLmhI/AAAAAAAAOpU/n2EFicBXYLw/s1600-h/image%25255B13%25255D.png"><img title="image" style="border-left-width: 0px; border-right-width: 0px; background-image: none; border-bottom-width: 0px; padding-top: 0px; padding-left: 0px; display: inline; padding-right: 0px; border-top-width: 0px" border="0" alt="image" src="https://lh3.googleusercontent.com/-D0IESvRI8Is/WJTwOveTqlI/AAAAAAAAOpY/hhU9IDL2fYA/image_thumb%25255B7%25255D.png?imgmax=800" width="654" height="462"></a></p> <p>What is also pretty confusing it the fact meshes can have only one side. This has the peculiar effect that at a lot of places you can look into the house from outside, but not outside the house from within. Anyway. This mesh is way too complex (the file is over 40mb) and messy. </p> <p><a href="https://lh3.googleusercontent.com/-U_zfMW7iq7s/WJXiNZyuIiI/AAAAAAAAOsI/ZXNje-r0YL0/s1600-h/image3.png"><img title="image" style="border-left-width: 0px; border-right-width: 0px; background-image: none; border-bottom-width: 0px; float: right; padding-top: 0px; padding-left: 0px; display: inline; padding-right: 0px; border-top-width: 0px" border="0" alt="image" src="https://lh3.googleusercontent.com/-6bOiOhpLxbA/WJXiN7Z9PQI/AAAAAAAAOsM/wbwAQDmmoEQ/image_thumb.png?imgmax=800" width="53" align="right" height="58"></a>Fortunately – there’s <a href="http://www.meshlab.net/" target="_blank">Meshlab</a>. And it’s free too. Thank heavens, because after you have bought a HoloLens you are probably quite of money ; )</p> <p>Meshlab has quite some tools to make your Mesh a bit smoother. Usually, when you look at a piece of mesh, like for instance the master bedroom, it looks kinda spikey – see left. But after choosing Filter/Remeshing, Simplication and Reconstruction/Simplification: Quadratic Edge Collapse Decimation</p> <p><a href="https://lh3.googleusercontent.com/-zsEw2JNrkUQ/WJXiOiVG3AI/AAAAAAAAOsQ/t-Osptgkgh0/s1600-h/image172.png"><img title="image" style="border-left-width: 0px; border-right-width: 0px; background-image: none; border-bottom-width: 0px; padding-top: 0px; padding-left: 0px; display: inline; padding-right: 0px; border-top-width: 0px" border="0" alt="image" src="https://lh3.googleusercontent.com/-BDFOXNRvaHk/WJXiPVzM0vI/AAAAAAAAOsU/9wpig_1YW60/image17_thumb1.png?imgmax=800" width="342" height="308"></a><a href="https://lh3.googleusercontent.com/-SW0DGaPgKI8/WJXiQF8B2nI/AAAAAAAAOsY/ICrrbK2wMCM/s1600-h/image201.png"><img title="image" style="border-left-width: 0px; border-right-width: 0px; background-image: none; border-bottom-width: 0px; padding-top: 0px; padding-left: 0px; display: inline; padding-right: 0px; border-top-width: 0px" border="0" alt="image" src="https://lh3.googleusercontent.com/-56TgbAOTVDY/WJXiQ4tyBoI/AAAAAAAAOsc/HVor1IUehEk/image20_thumb.png?imgmax=800" width="304" height="308"></a></p> <p>My house starts to look at lot less like the lair of the <a href="http://hyperioncantos.wikia.com/wiki/Shrike" target="_blank">Shrike</a> – it’s more like an undiscovered Antonio Gaudi building now. Hunt down the material used (in the materials subfolder), set it to transparent and play with color and transparency. I thought this somewhat transparent brown worked pretty well. Although there’s definitely still a lot of ‘noise’, it now definitely looks like my house, good enough for me to know where things are – or ought to be. </p><iframe height="365" src="https://www.youtube.com/embed/YrVnPaQjvOo" frameborder="0" width="650" allowfullscreen></iframe> <p>Using this Hologram of a space you can position <a href="http://localjoost.github.io/2017/01/31/scanning-physical-objects-with-xbox-one.html" target="_blank">Kinect-scanned objects</a> or 3d models relative to each other based upon their true relative positions without actually being in the room. Then, when you go back to the real room, all you have to to is to make sure the actual room coincides with the scanned room model – add world anchors to the models inside the room, and then get rid of the room Hologram. Thus, you can use this virtual room as a kind of ‘staging area’, which I successfully did for a client location to which physical access is very limited indeed.</p> <p>You might notice a few odd things – there are two holes in the floor in the living room – that is where the black leather couch and the black swivel chair are. As I’ve noticed before, black doesn’t work well with the HoloLens spatial mapping. Fascinating I find also the rectangular area that seems to float about a meter from left side of the house. That’s actually a large <em>mirror</em> that hangs on the bedroom wall, but the HoloLens spatial mapping apparently sees it as a reclined area. Very interesting. So not only this gives you a view of my house, but also a bit about HoloLens quirks. </p> <p>The project showed above, with both models (the full and the simplified one) in it, <a href="https://github.com/LocalJoost/SpatialObjDemo" target="_blank">can be found here.</a></p> <p><font size="1">* I love using the phrase “master bedroom” in relation to our house – as it conjures up images of a very large room like found in a typical USA suburban family house. I can assure you neither our house nor our bedroom do justice to that image. This is a Dutch house. But is <em>is</em> made out of concrete, unlike most houses in the USA, and will probably last way beyond my lifespan</font></p>