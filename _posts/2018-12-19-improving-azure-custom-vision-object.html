---
layout: post
title: Improving Azure Custom Vision Object Recognition by using and correcting the
  prediction pictures
date: '2018-12-19T11:16:00.001+01:00'
author: Joost van Schaik
tags:
- Custom Vision
- HoloLens
- Windows Mixed Reality
- Artificial Intelligence
- Machine Learning
modified_time: '2018-12-19T11:17:51.201+01:00'
thumbnail: https://lh3.googleusercontent.com/-bbjeprVv-fU/XBoaX55YhlI/AAAAAAAAQkQ/VWZBAobiUw4Gn0_eTgLyQ_2aIS5QuNTpACHMYCw/s72-c/image_thumb%255B4%255D?imgmax=800
blogger_id: tag:blogger.com,1999:blog-5295746446529817470.post-940337074535600552
blogger_orig_url: https://dotnetbyexample.blogspot.com/2018/12/improving-azure-custom-vision-object.html
---

<p>Intro</p><p>Last month I wrote about integrating Azure Custom Vision Object Recognition with <a href="https://www.microsoft.com/en-us/hololens" target="_blank">HoloLens</a> to recognize <a href="https://localjoost.github.io/2018/11/24/using-azure-custom-vision-object.html" target="_blank">to label objects in 3D space</a>. I wrote the prediction went pretty well, although I used only 35 pictures. I also wrote the process of taking, uploading and labeling pictures is quite tedious. </p><h2>Improving on the go</h2><p>It turns out Custom Vision retained <em>all</em> the pictures I uploaded in the cause of <em>testing</em>. So every time I used my HoloLens and asked Custom Vision to locate toy aircraft, it stored that in the cloud <em>with</em> it's prediction. And the fun thing is, you can <em>use</em> those pictures to actually improve your model again.</p><p>After some playing around with my model my (for the previous blog post about this subject) , I clicked the prediction tab, and I found about 30 pictures - each for every time I used the model from my HoloLens. I could use those to improve my model. After that, I did some more testing using the HoloLens to show you how it's done. So, I clicked the Predictions tab and there were a couple of more pictures:</p><p><a href="https://lh3.googleusercontent.com/-mfbrb6uA-qM/XBoaWztg6sI/AAAAAAAAQkM/f9aEnRrRpQIALKH0Au4Inj8ykKW2CRRAQCHMYCw/s1600-h/image%255B10%255D"><img width="640" height="350" title="image" style="border: 0px currentcolor; border-image: none; display: inline; background-image: none;" alt="image" src="https://lh3.googleusercontent.com/-bbjeprVv-fU/XBoaX55YhlI/AAAAAAAAQkQ/VWZBAobiUw4Gn0_eTgLyQ_2aIS5QuNTpACHMYCw/image_thumb%255B4%255D?imgmax=800" border="0"></a></p><p>If we select the first picture, we see this:</p><p><a href="https://lh3.googleusercontent.com/-AUEvrezI9ro/XBoaYyYbSFI/AAAAAAAAQkU/ta1_WG2-gII9SIUnkG71QSMR-EoP96f2wCHMYCw/s1600-h/image%255B15%255D"><img width="500" height="358" title="image" style="border: 0px currentcolor; border-image: none; display: inline; background-image: none;" alt="image" src="https://lh3.googleusercontent.com/-YfFZKIAdkZE/XBoaZ6AsFDI/AAAAAAAAQkY/MhUh-jyIcyEgRAIk-8fkLnQJNpncTAW_QCHMYCw/image_thumb%255B7%255D?imgmax=800" border="0"></a></p><p>The model has already annotated the areas where it thinks is a an airplane in red. Interestingly now the model is a lot better than it originally was (when it only featured my pre-loaded images) as it now recognizes the DC-3 Dakota on top - that it has never seen before - as an airplane! And even the X-15 (the black thing on the left ) is recognized. Although the X-15 had a few entries in the training images it barely looks like an airplane (for all intents and purpose it was more a spaceship with wings to facilitate a landing).</p><p>I digress. You need to click every area you want to confirm:</p><p><a href="https://lh3.googleusercontent.com/-k8Vl5QEd7oM/XBoaa_PYYDI/AAAAAAAAQkc/JPM7Q6j013kL9j8L07yexrs757cFSHbkACHMYCw/s1600-h/image%255B20%255D"><img width="500" height="315" title="image" style="border: 0px currentcolor; border-image: none; display: inline; background-image: none;" alt="image" src="https://lh3.googleusercontent.com/-JSUKN7mWQgg/XBoablDpxpI/AAAAAAAAQkg/E5dNYUfoWFE1-fSQXe9Ne7o2E6YW1kYqwCHMYCw/image_thumb%255B10%255D?imgmax=800" border="0"></a></p><p>And when you are done, and all relevant areas are white:</p><p><a href="https://lh3.googleusercontent.com/-h6CNy8eeqAI/XBoacd-t2II/AAAAAAAAQkk/83xLUDxoMgMqYQfLnwzx5vN4l7ZDZwf-QCHMYCw/s1600-h/image%255B25%255D"><img width="500" height="317" title="image" style="border: 0px currentcolor; border-image: none; display: inline; background-image: none;" alt="image" src="https://lh3.googleusercontent.com/-_sNsKBTX7hc/XBoadKG6n9I/AAAAAAAAQko/EIMgYbqbZYAUUXw9UYb7_TPVm_YyfEupwCHMYCw/image_thumb%255B13%255D?imgmax=800" border="0"></a></p><p>Simply click the X top right. The image will now disappear from the "Predictions" list and end up in the "Training images" list</p><h2>Some interesting things to note</h2><p>The model really improved from adding the new images. Not only did it recognize the DC3 'Dakota' that had not been in the training images, but also this Tiger Moth model (the bright yellow one) that it had never&nbsp; seen before:</p><p><a href="https://lh3.googleusercontent.com/-vDr3YtxDhLE/XBoaeF_NhuI/AAAAAAAAQks/mpxHkFB7hWIe6wO1A60IR4bRxQpXwk_mwCHMYCw/s1600-h/image%255B37%255D"><img width="350" height="197" title="image" style="border: 0px currentcolor; border-image: none; display: inline; background-image: none;" alt="image" src="https://lh3.googleusercontent.com/-ZTw7khxZ93M/XBoaew3YchI/AAAAAAAAQkw/VMTPJHZQJ6UoqwfuCP6U_7PObFZQjbE1gCHMYCw/image_thumb%255B21%255D?imgmax=800" border="0"></a></p><p>Also, it stopped recognizing or doubting things like the HoloLens pouch that's lying there, and my headphones and hand were also recognized as 'definitely not an airplane' </p><p><a href="https://lh3.googleusercontent.com/-ke0zNoAZ6rw/XBoafkQyE6I/AAAAAAAAQk0/XSKZuKiURc0-EXxDfPILPpHqqWDeaZtfgCHMYCw/s1600-h/image%255B41%255D"><img width="354" height="202" title="image" style="display: inline; background-image: none;" alt="image" src="https://lh3.googleusercontent.com/-bonlCU0wiRc/XBoagU5vMBI/AAAAAAAAQk4/8sl4Vj4l2VUMkr4rMzHjg06BuvV-rsmTgCHMYCw/image_thumb%255B23%255D?imgmax=800" border="0"></a></p><p>Yet, I also learned it's dangerous to take the same background over and over again. Apparently the model starts to rely on that. If I put the Tiger Moth on a dark blue desk chair in stead of a light blue bed cover</p><p><a href="https://lh3.googleusercontent.com/-ek9lf5RYU3g/XBoahbcTmEI/AAAAAAAAQk8/i7MjDA1YtuQXvbkODz0fnTRStq-vd7ZCwCHMYCw/s1600-h/image%255B46%255D"><img width="350" height="210" title="image" style="border: 0px currentcolor; border-image: none; display: inline; background-image: none;" alt="image" src="https://lh3.googleusercontent.com/-VAgtV4Wy61w/XBoaiFyckpI/AAAAAAAAQlA/7VgK8p3Kz3M4gUavoz_kh9INHZNMAEPLACHMYCw/image_thumb%255B26%255D?imgmax=800" border="0"></a></p><p>Yes...&nbsp; the model is quite confident airplane in the picture but it's not very good at pinpointing it.</p><p><a href="https://lh3.googleusercontent.com/-LVcUVcjjvr8/XBoai0BSfSI/AAAAAAAAQlE/44pXJtBw6Zcyta_ailspbBZCT-q_cFFdQCHMYCw/s1600-h/image%255B54%255D"><img width="350" height="195" title="image" style="border: 0px currentcolor; border-image: none; display: inline; background-image: none;" alt="image" src="https://lh3.googleusercontent.com/-a7Eluo8su5E/XBoaj6k1ZRI/AAAAAAAAQlI/bhzc-vU75-UyQBs674XTAEeHlHD-pRUWACHMYCw/image_thumb%255B30%255D?imgmax=800" border="0"></a></p><p>And as far as the Curtiss P40 'Kittyhawk' goes - even though it has been featured <em>extensively</em> in both the original training pictures <em>and</em> the ones I added from the Predictions, this no is success either. The model is better at pinpointing the aircraft, but considerably less sure<em>&nbsp;</em>it <em>is</em> an aircraft. And the outer box, that includes the chair, gives a 30.5%. So in looks that to make this model even more reliable I still need <em>more</em> pictures but then on other background, more different lighting, etc. </p><h2>Conclusion</h2><p>You don't have to take very much pictures up front to incrementally improve a Custom Vision Object Recognition model - you can just iterate on it's predictions and improve them. It feels a bit like teaching a toddler how to build something from Legos - you first show the principle, then let them muck around, and every time things goes wrong, you show how it should have been done. Gradually they get the message. Or at least, that's what you hope. ;) </p><p>No (new) code this time, as the <a href="https://github.com/LocalJoost/ToyAircraftFinder" target="_blank">code from last time</a> is unchanged.</p><p>Disclaimer - I have no idea how much prediction pictures are stored and for how long - I can imagine not indefinitely, and not an unlimited amount. But I can't attach numbers to that.</p>