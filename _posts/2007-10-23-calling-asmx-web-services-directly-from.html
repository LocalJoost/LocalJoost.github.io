---

title: Calling ASMX web services directly from javascript
date: '2007-10-23T14:42:00.003+02:00'
orgauthor: Joost van Schaik
tags:
- C#
- ASP.NET AJAX
- JSON
- Web Services
- Javascript
modified_time: '2008-10-15T12:57:40.509+02:00'
blogger_id: tag:blogger.com,1999:blog-5295746446529817470.post-2671510279120310491
blogger_orig_url: https://dotnetbyexample.blogspot.com/2007/10/calling-asmx-web-services-directly-from.html
---

The AJAX hype is all around us, and Microsoft provided us with the very neat ASP.NET AJAX extensions and the control toolkit to make things easier. The UpdatePanel and its nephews enjoy a lot of time in the spotlight. The workhorse in the background that makes this all possible can also be used 'raw' - that is, you can call web services directly from javascript utilizing the standard structure of ASP.NET Ajax. It is a very efficient way to transfer data to and from the browser because the server transforms it into <em>JSON</em> - so no large chunks of verbose XML are send through the wire and you don't have to write elaborate pieces of XML-parsing javascript.<br />Follow the steps below to get things up and running.<br /><br />This example assumes you have ASP.NET Ajax and de Web Applications already installed.<br /><br /><span style="font-size:130%;">1. Create a new project of type "ASP.NET AJAX-Enabled Web Application"</span><br />This will create a new Web Application with a Default.aspx that already has a script manager on in, and a preconfigured web.config. Call this project WebServiceDemo<br /><br /><span style="font-size:130%;">2. Add a web service</span><br />Right-click on your web application, click Add/New Item and then Web Service. Call this web service "DemoService".<br /><br /><span style="font-size:130%;">3. Make a web service callable from script</span><br />Open code file "Default.aspx.cs". Notice your class "DemoService" sits in a namespace "WebServiceDemo". You will need this knowlegde later.<br />Add to the top:<br /><br /><pre>using System.Web.Script.Services;</pre>decorate the class with the attribute [ScriptService] and modify the standard hello world method so it looks like this:<br /><br /><pre>[WebService(Namespace = "http://tempuri.org/")]<br />[WebServiceBinding(ConformsTo = WsiProfiles.BasicProfile1_1)]<br />[ToolboxItem(false)]<br /><span style="FONT-WEIGHT: bold">[ScriptService]</span><br />public class DemoService : System.Web.Services.WebService<br />{<br /> [WebMethod]<br /> public string HelloWorld( <span style="FONT-WEIGHT: bold">string ToSomeone )</span><br /> {<br />   return "Hello World" <span style="FONT-WEIGHT: bold">+ ToSomeone</span><span style="font-size:0;">;</span><br /> }<br />}<br /></pre><span style="font-size:130%;">4. Register the service on the page where you want to call it from</span><br />Open Default.aspx in design view and select the ScriptManager1<br />Select the "Services" property, and click the button that appears<br />Click "Add", and enter "DemoService.asmx" for the path property<br />Click OK. The result should look like this:<pre>&lt;asp:ScriptManager ID="ScriptManager1" runat="server" &gt;
  &lt;Services&gt;
    &lt;asp:ServiceReference Path="DemoService.asmx" /&gt;
  &lt;/Services&gt;
&lt;/asp:ScriptManager&gt;</pre><span style="font-size:130%;">5. Create a client side script to perform the call</span><br />Open Default.aspx in source view and enter just before the &lt;head&gt; tag the following code:<br /><br /><pre><span style="FONT-WEIGHT: bold"></span>&lt;script type="text/javascript"&gt;<br /> function CallService()<br /> {<br />   WebServiceDemo.DemoService.HelloWorld( "Yourself",<br />   Callback );<br /> }<br /><br /> function Callback( result )<br /> {<br />   var outDiv = document.getElementById("outputDiv");<br />   outDiv.innerText = result;<br /> }<br />&lt;/script&gt;<span style="FONT-WEIGHT: bold"></span></pre><span style="font-size:130%;">6. Create a button to start the web service calling function</span><br />Drag a button onto the form<br />Set the property "OnClientClick" to "CallService();return false;"<br /><br /><span style="font-size:130%;">7. Create div for the output data</span><br />Drag a div (from the HTML tab) onto the form.<br />Set its id to "outputDiv";<br /><br />If you did everything correctly, the text "Hello World Yourself" should appear beneath your button, without a visible postback.<br /><br />Notice the following things:<br /><br /><ul><li>You always need the fully qualified name of the class to call the webservice: <span style="FONT-WEIGHT: bold">WebServiceDemo.DemoService</span>.HelloWorld</li><li>Calling a webservice from javascript always needs two methods: one to make the actual call, and one to receive the results</li><li>The callback method is added as an extra parameter to the web service method parameters. In C#, the method has one parameter, so in javascript two. </li></ul>This sample gives a nice under-the-hood sample of how ASP.NET Ajax transfers data to and from the browser.<br /><br />Complete code downloadable <a href="http://www.schaikweb.net/dotnetbyexample/WebServiceDemo.zip">here</a>.