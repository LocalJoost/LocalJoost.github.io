---

title: HoloLens CubeBouncer application part 1 - setting up the Unity part
date: '2016-07-06T17:59:00.001+02:00'
orgauthor: Joost van Schaik
tags:
- UWP
- HoloLens
- Unity3D
modified_time: '2016-07-28T08:39:57.969+02:00'
thumbnail: https://i.ytimg.com/vi/X_Zo1lCTT9c/default.jpg
blogger_id: tag:blogger.com,1999:blog-5295746446529817470.post-261263247121477182
blogger_orig_url: https://dotnetbyexample.blogspot.com/2016/07/hololens-cubebouncer-application-part-1.html
---

<h2>Preface</h2>Ever since I knew the <a href="https://www.microsoft.com/microsoft-hololens/" target="_blank">HoloLens</a> was coming to my company I have been digging into all the online resources I could find. And ever since the devices arrived on June 8th, I have been more or less pleading insanity with my wife, as I spent quite some spare time just trying to get ever deeper into <a href="https://www.microsoft.com/microsoft-hololens/" target="_blank">HoloLens development</a> with Unity3D and C#. What surprised me most was how easy it was to actually get started and get on with it, and get a pretty functional app within a quite short amount of time – with shockingly little code.<br>I will write the way I created the app as a series of blog posts (and not a single one) to prevent individual posts from becoming too long. They will serve both as an educational piece for those interested in HoloLens programming (as working examples with explanations are still pretty rare) and for myself – to remember how I actually <em>came</em> to this. <br> <ul> <li>In this first part I will describe the app, write how to create an app in Unity3D, and how to design some basic characteristics of a 3D object  <li>In <a href="http://localjoost.github.io/2016/07/09/hololens-cubebouncer-application-part-2.html" target="_blank">Part 2</a> I will describe the basic setup – how the grid is created with respect to user’s view angle  <li>In <a href="http://localjoost.github.io/2016/07/13/hololens-cubebouncer-application-part-3.html" target="_blank">Part 3</a> I will add basic manipulation (air tapping the cubes and making them bounce) as well as the first spatial sound  <li><a href="http://localjoost.github.io/2016/07/23/hololens-cubebouncer-application-part-4.html" target="_blank">Part 4</a> will introduce speech recognition and he first two speech commands – “create new grid” and “go to start”  <li><a href="http://dotnetbyexample.blogspot.nl/2016/07/hololens-cubebouncer-application-part-5.html" target="_blank">Part 5</a> will describe the use of gravity via the speech commands “drop”, “drop all”; we will implement “total recall”, add missing sounds, and do some fit &amp; finish. </li></ul> <h2>Description and features of the app</h2>The app creates a grid of cubes floating in the air. Up and sideways it’s a fixed number of cubes (4x4), the number in depth is determined by the space available between you and a wall or object you are gazing at. The grid is also rotated in space according to your head’s position, so if you tilt your head a and gaze up to the left, so will the grid be tilted and stacked up to the upper left. In other words – you will always look at a grid that is exactly aligned with your gaze – when the grid is created. After that you can walk around it and manipulate it to your hearts content:<br> <ul> <li>Air tapping while the gaze cursor is on the cube will push it away from you as if you had poked it with a stick that comes directly out of your eyes. Cubes will move away from you, rotate and bounce off each other - and any physical objects HoloLens has detected. When they hit each other, the make a kind of clicking sound, when they hit a physical object, a kind of low boom sounds. And of course, all from the right direction. Spatial Sound FTW.  <li>When you gaze at a cube and say “go to start” it will move back to it’s original position, emitting a kind of whistling sound while doing so. And bump out of the way any other cubes being in the way ;)  <li>Gazing at a cube while saying “drop” will let the cube drop to the floor  <li>Saying&nbsp; “drop all” will make <em>all</em> cubes drop to the floor (you don’t need to gaze at a particular cube)  <li>Saying “total recall” will make <em>all</em> cubes return to their initial original position. More or less. Unless they hit each other on the way ;)&nbsp; <li>Saying “create new grid” will create a new grid of cubes – once again it’s direction following your gaze. </li></ul>An additional feature, handy for demo’s – if HoloLens cannot find a point on a wall or object while trying to create a grid in 10 seconds (because it’s still scanning the room, or there simply <em>is</em> nothing in front of it) it will pick a place in front of you about 3.5 meters before you and assume that to be the wall. You get a fairly small grid then. <br>I have shown some intermediate stages of the app – here it is in it’s final form.<br><iframe height="365" src="https://www.youtube.com/embed/X_Zo1lCTT9c" frameborder="0" width="650" allowfullscreen=""></iframe><br>And I am going to show you how to build it. It’s 90% Unity3D stuff, and very little custom code. And part of it is nicked from Microsoft, too. Actually I only wrote three&nbsp; classes all by myself.<br> <h2>Suggested material before starting</h2>If you are totally new to Unity3D (like I was) I would strongly suggest doing some introductory stuff first. Otherwise, I will be talking mostly nonsense to you. Start out with the <a href="https://channel9.msdn.com/Series/UnityCreativeCoding" target="_blank">Creative Coding series</a> by the brilliant <a href="http://twitter.com/rickbarraza" target="_blank">Rick Barraza</a>. I found it very enlightening, although it is slightly off target when you are a hard core coder like me – Rick is talking at length at things you will find elementary as a coder, while some Unity3D concepts go by at a speed that made me pause and go back a few times ;). But it is a very good series to make you feel comfortable with Unity3D editor and the basic concepts. I would also suggest a few lessons on the <a href="https://developer.microsoft.com/en-us/windows/holographic/academy" target="_blank">Holographic Academy</a> to get you familiar with HoloLens interaction programming. I would particularly suggest lessons <a href="https://developer.microsoft.com/en-us/windows/holographic/holograms_100" target="_blank">101</a> and <a href="https://developer.microsoft.com/en-us/windows/holographic/holograms_101" target="_blank">101</a> (or <a href="https://developer.microsoft.com/en-us/windows/holographic/holograms_101e" target="_blank">101E</a>, if you don’t have a HoloLens). It’s rather amusing to see that the Academy series is heavily slanted toward coders, while Rick is more slanted toward designers, so together they make a good introduction.<br>For editor layout, I took Rick’s suggestion of taking the “tall” layout (Window/layouts/tall) so that is what you will see in the screenshots. It is <em>not</em> the default Unity3D layout.<br> <h2>Create a new Unity3D project</h2>The most important part – think of a good name, as it’s not easy to change it. I would strongly suggest following a few steps as described in my fellow MVP Morten Nielsen’s blog, most notably:<br> <ul> <li><a href="http://sharpgis.net/post/2016/04/10/Creating-your-very-first-holographic-app-in-Unity" target="_blank">Creating a bare bones project with the right settings</a>  <li><a href="http://sharpgis.net/post/2016/04/10/Installing-HoloLens-HoloToolkit-into-your-Unity-Project">Installing HoloLens HoloToolkit into your Unity Project</a>  <li><a href="http://sharpgis.net/post/2016/04/10/Using-HoloLens-Spatial-Mapping-to-occlude-objects">Using HoloLens’ Spatial Mapping to occlude objects</a>  <li><a title="Adding a Gaze Cursor to your HoloLens App" href="http://sharpgis.net/post/2016/04/14/Adding-a-Gaze-Cursor-to-your-HoloLens-App">Adding a Gaze Cursor to your HoloLens App</a> </li></ul>I tend to do a few things different:<br> <ul> <li>With regards to the HoloToolkit, I only copy all the files under “Assets” from the zip file in a folder “HoloToolkit” under “Assets” in my Unity3D project as I like to keep the things I make and import as a whole differently.  <li>I put the cursor at root level, in stead of inside a ‘Managers’ game object (although I do create it, but for other purposes)  <li>I set the Near Clipping Plane of the Camera to 0.1, unlike Morten, but do whatever you like. </li></ul>At the moment of this writing, I got some errors importing the HoloToolkit in the Sharing subfolder. As we don’t need this anyway, I deleted it completely. <br>I also add a few things up front:<br> <ul> <li>To enable speech recognition, we have to enable the Microphone. That’s done by File/Build Settings/Player Settings, then opening the “Publishing settings”, scrolling all the way to the bottom to Capabilities, then checking “Microphone”  <li>To prevent a horribly magenta painted surroundings, I set the occlusion material of the SpatialMappingRender to, indeed. occlusion. I have <a href="http://localjoost.github.io/2016/06/01/default-hololens-toolkit-occlusion.html" target="_blank">described this procedure in an earlier blog post</a>.<!--EndFragment--> </li></ul>So, if you are done following Morten’s steps and my additions/changes, you should end up with the following:<br><a href="https://lh3.googleusercontent.com/-vS_P-fFNTbM/V3qS0v9AndI/AAAAAAAAOA8/44spSCvqavU/s1600-h/image%25255B3%25255D.png"><img title="image" style="border-left-width: 0px; border-right-width: 0px; background-image: none; border-bottom-width: 0px; padding-top: 0px; padding-left: 0px; display: inline; padding-right: 0px; border-top-width: 0px" border="0" alt="image" src="https://lh3.googleusercontent.com/--ZZ5WW6YF-U/V3qS1CaVUKI/AAAAAAAAOBA/2sZzY0_PPf0/image_thumb%25255B1%25255D.png?imgmax=800" width="521" height="484"></a><br>When you are done with this, hit “File/Save Scene” and choose a name you like. I tend to choose “MainScene”. <br> <h2>A little organization up front</h2>I like to keep things a bit organized, so I keep stuff I made myself and/or is part of my app) apart from 'the rest', that is, the HoloLens toolkit. This makes updating easier. So I created a folder "Custom" in my assets and added a number of sub folders to it:<br><a href="https://lh3.googleusercontent.com/-nWistk5tAkg/V3y_0x1K4NI/AAAAAAAAOBQ/C35WBTvfWuA/s1600-h/image%25255B3%25255D.png"><img title="image" style="border-left-width: 0px; border-right-width: 0px; background-image: none; border-bottom-width: 0px; padding-top: 0px; padding-left: 0px; display: inline; padding-right: 0px; border-top-width: 0px" border="0" alt="image" src="https://lh3.googleusercontent.com/-bSq1O3WUE8Q/V3y_1OAxj3I/AAAAAAAAOBU/xi7XJ4VLfpQ/image_thumb.png?imgmax=800" width="244" height="232"></a><br> <h2>Creating the cube looks</h2><a href="https://lh3.googleusercontent.com/-RokPDPgARCs/V3y_1ewPWrI/AAAAAAAAOBY/c8Lzfn0yY8I/s1600-h/image%25255B11%25255D.png"><img title="image" style="border-left-width: 0px; border-right-width: 0px; background-image: none; border-bottom-width: 0px; float: right; padding-top: 0px; padding-left: 0px; display: inline; padding-right: 0px; border-top-width: 0px" border="0" alt="image" src="https://lh3.googleusercontent.com/-ZqIXtu4WMnM/V3y_16wwDBI/AAAAAAAAOBc/BHwZgwot4AI/image_thumb%25255B3%25255D.png?imgmax=800" width="140" align="right" height="149"></a>Click “HologramCollection” in the hierarchy pane, right-click, select 3D-object and then “Cube”. Done ;). You get a white 1x1 cube, that’s a bit big and a bit boring. So what we are going to do next is get a <em>material</em> for it that has a more interesting look. I guess I wanted to impress our CTO (hi <a href="https://twitter.com/dannyburlage" target="_blank">Danny</a> ;) ) so I took a <a href="http://wortell.nl/" target="_blank">Wortell</a> company logo - that is conveniently square. But of course you can take any image you like. In Unity3D terminology, that’s a <em>texture,</em> so I dragged that image into my newly created textures folder. But you cannot directly use a texture on a 3D element – you need a <em>material.</em><br>So inside our Assets/Custom/Materials folder we right-click, select Create, then click “Material”. In the top of the inspector, a drop down box is shown labeled “Shader”. Change that to Mobile/Bumped diffuse. The UI below it will change – you will see two grey areas. Hit the “select” button from the top one, select the image you want from the popup, and you are done. Alternatively, you can also drag it from the textures folder on top of the grey area. Either way, the net result should be this:<br><a href="https://lh3.googleusercontent.com/-3zaUzGw8S_E/V3y_2L6Nh-I/AAAAAAAAOBg/u0hLSCD3I2o/s1600-h/image%25255B15%25255D.png"><img title="image" style="border-left-width: 0px; border-right-width: 0px; background-image: none; border-bottom-width: 0px; padding-top: 0px; padding-left: 0px; display: inline; padding-right: 0px; border-top-width: 0px" border="0" alt="image" src="https://lh3.googleusercontent.com/-pwkY5FPjctg/V3y_2dJoTiI/AAAAAAAAOBk/oVxfvWh_MIU/image_thumb%25255B5%25255D.png?imgmax=800" width="453" height="484"></a><br>It gives some warning for better performance – people who understand Unity3D better than me will no doubt have suggestions to fix this. For now, it will work. But your material is now still called “New Material” – I renamed it to “WortellLogo”. <br>Now select the cube in the Hierarchy pane, open the Assets Custom/Materials folder and drag the new Material on top of the Inspector pane, just below the Material <br><a href="https://lh3.googleusercontent.com/-Yyds-K9IFM8/V3y_2h0tk5I/AAAAAAAAOBo/Qi45Hkezgmw/s1600-h/image%25255B19%25255D.png"><img title="image" style="border-left-width: 0px; border-right-width: 0px; background-image: none; border-bottom-width: 0px; padding-top: 0px; padding-left: 0px; display: inline; padding-right: 0px; border-top-width: 0px" border="0" alt="image" src="https://lh3.googleusercontent.com/-3u3zCCm6iMo/V3y_2xlq07I/AAAAAAAAOBs/xG2FqqGf2Bc/image_thumb%25255B7%25255D.png?imgmax=800" width="541" height="484"></a><br>Your result should be this (if you zoom in a little on the Scene)<br><a href="https://lh3.googleusercontent.com/-So0KG93c7aA/V3y_3R_HsoI/AAAAAAAAOBw/lRjO5h0proQ/s1600-h/image%25255B23%25255D.png"><img title="image" style="border-left-width: 0px; border-right-width: 0px; background-image: none; border-bottom-width: 0px; padding-top: 0px; padding-left: 0px; display: inline; padding-right: 0px; border-top-width: 0px" border="0" alt="image" src="https://lh3.googleusercontent.com/-3cWgKpmdtlg/V3y_3rZAuZI/AAAAAAAAOB0/p2kvq56Vgko/image_thumb%25255B9%25255D.png?imgmax=800" width="644" height="361"></a><br>One cube, with logo, nearly done. We will need only need change one more thing – the cube is a wee bit big. Under transform (on top of the inspector) change the Scale to 0.1 for X, Y and Z.<br> <h2>Adding some physics (and other) components to the cube</h2><a href="https://lh3.googleusercontent.com/-Zc5bUoNRihI/V3y_3yocX_I/AAAAAAAAOB4/qkyYxYfS4xE/s1600-h/image%25255B77%25255D.png"><img title="image" style="border-left-width: 0px; border-right-width: 0px; background-image: none; border-bottom-width: 0px; float: right; padding-top: 0px; padding-left: 0px; display: inline; padding-right: 0px; border-top-width: 0px" border="0" alt="image" src="https://lh3.googleusercontent.com/-aKT_PJ9OZzE/V3y_4LbDEwI/AAAAAAAAOB8/sNhNKZXTgNA/image_thumb%25255B61%25255D.png?imgmax=800" width="187" align="right" height="128"></a>To be able to make the cube be moved and controlled by the Unity3D physics engine, we will need a component that describes it’s physical characteristics. That component is called a “Rigidbody”. So hit the “Add Component” button to the right in the cube Inspector, type “rig” in the search box to make finding the right component easier, and select Rigidbody. I have changed some default settings, but you are free to play with your own – the most important thing is to turn off “Use Gravity”<br><a href="https://lh3.googleusercontent.com/-enu6KCCJdQs/V3y_4YnnC9I/AAAAAAAAOCA/Q3ANmFPy9fs/s1600-h/image%25255B83%25255D.png"><img title="image" style="border-left-width: 0px; border-right-width: 0px; background-image: none; border-bottom-width: 0px; padding-top: 0px; padding-left: 0px; display: inline; padding-right: 0px; border-top-width: 0px" border="0" alt="image" src="https://lh3.googleusercontent.com/-1829j0jT4KY/V3y_4t7WjhI/AAAAAAAAOCE/Ygk3K5vi6Qk/image_thumb%25255B63%25255D.png?imgmax=800" width="244" height="152"></a><br>A second part of the physical characteristics is defined by the <em>physical </em>material. This, apparently, defines how things collide – how bouncy they are, and how smooth. You can image two ice cubes sliding over each other showing different behavior than two rugged wood cubes. Anyway – select folder “PhysicMaterials’', right-click, and select Physic Material. I have called it “BouncyStuff”, but you may call it whatever you like. I have given it the following settings:<br><a href="https://lh3.googleusercontent.com/-Jne_2tNXhCQ/V3y_43RHi3I/AAAAAAAAOCI/3re-FpFUKXo/s1600-h/image%25255B86%25255D.png"><img title="image" style="border-left-width: 0px; border-right-width: 0px; background-image: none; border-bottom-width: 0px; padding-top: 0px; padding-left: 0px; margin: 0px; display: inline; padding-right: 0px; border-top-width: 0px" border="0" alt="image" src="https://lh3.googleusercontent.com/-7xMQdvCCEgE/V3y_5DaOnnI/AAAAAAAAOCM/XlR7LyhPVs8/image_thumb%25255B64%25255D.png?imgmax=800" width="244" height="131"></a><br>To apply this material, you will need to drag this material on top of the “Material” box of the “Box Collider” inside your cube, that was created by default.<br><a href="https://lh3.googleusercontent.com/-EwVAypEJIZs/V3y_5tCM9HI/AAAAAAAAOCQ/Papfu__Wxf8/s1600-h/image%25255B90%25255D.png"><img title="image" style="border-left-width: 0px; border-right-width: 0px; background-image: none; border-bottom-width: 0px; padding-top: 0px; padding-left: 0px; display: inline; padding-right: 0px; border-top-width: 0px" border="0" alt="image" src="https://lh3.googleusercontent.com/-ZRdDhzwn2VE/V3y_58WCgBI/AAAAAAAAOCU/FwxSrlaXPNg/image_thumb%25255B66%25255D.png?imgmax=800" width="542" height="484"></a><br>Finally, to make the cube be able to emit sound from the right direction we have to add an Audio Source. You can find an article <a href="https://developer.microsoft.com/en-us/windows/holographic/spatial_sound_in_unity" target="_blank">here</a> on enabling spatial sound in your project. I tend to do things a bit different in this project, because I found it sounded better in my case. Anyway – once more, hit “Add Component” and select “Audio Source”. Expand it, then change the settings as follows:<br> <ul> <li>Uncheck “Play on awake”  <li>Set “Volume” to 0.5  <li>Drag the slider “Spatial Blend” all the way to 3D  <li>Under “3D Sounds settings”, set Max Distance to 15 </li></ul>Net result should be this<br><a href="https://lh3.googleusercontent.com/-MB_wYXJxfA0/V3zKZ95OKCI/AAAAAAAAOCk/lRcKEW8sl2w/s1600-h/image%25255B94%25255D.png"><img title="image" style="border-left-width: 0px; border-right-width: 0px; background-image: none; border-bottom-width: 0px; padding-top: 0px; padding-left: 0px; display: inline; padding-right: 0px; border-top-width: 0px" border="0" alt="image" src="https://lh3.googleusercontent.com/-OhaVQ81Yutg/V3zKaSRLsdI/AAAAAAAAOCo/fN-ZRzUcnFM/image_thumb%25255B68%25255D.png?imgmax=800" width="195" height="484"></a><br>Our Cube is now done. <br> <h2>Looking at the result so far</h2><a href="https://lh3.googleusercontent.com/-VQrbi8EtG1k/V3znXMljCHI/AAAAAAAAOC4/MtVC0x7Vi0I/s1600-h/image%25255B105%25255D.png"><img title="image" style="border-left-width: 0px; border-right-width: 0px; background-image: none; border-bottom-width: 0px; float: right; padding-top: 0px; padding-left: 0px; display: inline; padding-right: 0px; border-top-width: 0px" border="0" alt="image" src="https://lh3.googleusercontent.com/-N9QMaxzbv_Y/V3znXoJaZEI/AAAAAAAAOC8/JL9i1nZ3ofI/image_thumb%25255B71%25255D.png?imgmax=800" width="244" align="right" height="201"></a><br>As you may have noticed, we still have not written a single line of code. Yet, we already have a working application. Hit File/Build Settings/Build, build the app and deploy to the HoloLens or an emulator. The “Made with Unity” logo will pop up, and then nothing. Or so it seems. We have positioned our cube at 0,0,0 which seems to be the location of the HoloLens as the application starts up. Anyway – get up, turn around, look to where your head was, and there it is….<br> <h2>Concluding remarks</h2>The solution so far can be found <a href="https://github.com/LocalJoost/CubeBouncer/tree/blog1" target="_blank">here</a>. If you are impatient, and want to play with the already finished app directly, <a href="https://1drv.ms/u/s!AjesCJDYqwYkzJY8GdAbaXCggw77yg" target="_blank">download an app package here</a> and install it on your HoloLens. Beware of the dependencies you will need to install as well! <br>Apart from the people already mentioned in this article, I want to particularly say thanks to <a href="https://twitter.com/vbandi" target="_blank">András Velvárt (aka vbandi)</a> who, apart from being a smart, friendly and very accessible person, gave me some particular good advice on some issues with the spatial mapping, and the HoloLens environment scanning rate. He also pointed me to the Creative Coding series. 