---

title: Calling a service relative to the Silverlight XAP (improved)
date: '2009-07-18T18:28:00.006+02:00'
orgauthor: Joost van Schaik
tags:
- Relative path
- dotnetmag
- Service
- Silverlight
- WCF
- Web Services
- Extension methods
modified_time: '2010-04-06T11:17:29.881+02:00'
blogger_id: tag:blogger.com,1999:blog-5295746446529817470.post-486165729680206345
blogger_orig_url: https://dotnetbyexample.blogspot.com/2009/07/calling-service-relative-to-silverlight_18.html
---

<a href="http://localjoost.github.io/calling-service-relative-to-silverlight">In my previous post</a> I showed a way to call a service defined with a full path, as created by the designer, relative to that of the location of your XAP, by means of an extension to a user control. I developed that during a training and while blogging it I alreadly realized that there was room for improvement. And here it is:<pre>using System;
using System.ServiceModel;
using System.ServiceModel.Description;
using System.Windows;

namespace LocalJoost.Utilities.Silverlight
{
  public static class ServiceEndpointExtension
  {
    public static void MakeRelative(
      this ServiceEndpoint endpoint)
    {
      var clientbinLocation = 
        Application.Current.Host.Source.ToString().Substring(0,
        Application.Current.Host.Source.ToString().LastIndexOf("/"));
      var rootLocation = 
        clientbinLocation.Substring(0, 
        clientbinLocation.LastIndexOf("/"));
      endpoint.Address = new EndpointAddress(
        new Uri(string.Concat(rootLocation, 
          endpoint.Address.Uri.AbsolutePath)));
    }
  }
}</pre>In stead of extending the user control I now extend the <em>ServiceEndpoint</em>. If you now want to call a service that is sitting in the root of your web application that is hosting you can call it like this:<pre>var client = new CloudMapperDataServiceClient();
client.Endpoint.Address.MakeRelative();</pre>Substitute "CloudMapperDataServiceClient" by your own client proxy class  and you are go for launch (Sorry, currently listening to wechoosethemoon.org ;-)